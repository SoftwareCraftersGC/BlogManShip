<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/paper-styles/color.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable-behavior.html">
<link rel="import" href="../bower_components/marked-element/marked-element.html">

<dom-module id="list-view">
  <template>
    <style>
      :host {
        @apply(--layout-vertical);
      }

      .main {
        @apply(--layout-flex);
        @apply(--layout-scroll);
      }
      paper-card {
          width: calc(100% - 20px);
          margin: 10px;
      }
      paper-card .card-actions p{
          text-align: right;
          margin: 2px;
          font-size: smaller;
      }

      paper-card .card-actions p:first-child {
          float: left;
      }
    </style>

    <div class="main">
        <template is="dom-repeat" items="[[data]]" as="post">
            <paper-card heading="[[post.title]]" on-tap="_onClick" post="[[post]]">
              <div class="card-content">
                  <marked-element markdown="[[post.content]]">
                      <div class="markdown-html"></div>
                  </marked-element>
              </div>
              <div class="card-actions">
                  <p>[[post.author]]</p>
                  <p>8 de Abril de 2016</p>
              <div>
            </paper-card>
        </template>

    </div>

  </template>

</dom-module>

<script>

  Polymer({

    is: 'list-view',

    behaviors: [
      Polymer.NeonAnimatableBehavior
    ],

    properties: {

      data: {
        type: Array,
        value: function() {
          return [];
        }
      },

      animationConfig: {
        type: Object,
        value: function() {
          return {
            'entry': [{
              name: 'fade-in-animation',
              node: this
            }],

            'exit': [{
              name: 'hero-animation',
              id: 'hero',
              fromPage: this
            }]
          };
        }
      }

    },

    _onClick: function(event) {
      this.sharedElements = {
        'hero': event.target,
      };

      var element = event.target;

      while (element.tagName.toLowerCase() !== 'paper-card') {
          element = element.parentNode;
      }

      this.fire('item-click', {
        item: event.target,
        post: element.post
      });
    }

  });

</script>
